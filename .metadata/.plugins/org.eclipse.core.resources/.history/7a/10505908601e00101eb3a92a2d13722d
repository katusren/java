package chapter06;

import javax.swing.*;
import java.awt.*;
import java.awt.event.*;
import java.util.Random;

public class GUIUpDownGame extends JFrame {
    private int answer;
    private int tries = 0;

    private JTextField inputField;
    private JButton guessButton;
    private JLabel resultLabel;
    private JLabel triesLabel;

    public GUIUpDownGame() {
        // 랜덤 숫자 생성
        answer = new Random().nextInt(100) + 1;

        // 프레임 기본 설정
        setTitle("🎮 Up-Down Game");
        setSize(400, 250);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setLocationRelativeTo(null); // 화면 중앙에 표시
        setLayout(new GridLayout(5, 1));

        // 폰트 설정
        Font font = new Font("Arial", Font.BOLD, 18);

        // 상단 안내 메시지
        JLabel titleLabel = new JLabel("Guess a number between 1 and 100!", SwingConstants.CENTER);
        titleLabel.setFont(font);
        titleLabel.setForeground(new Color(0, 102, 204));
        add(titleLabel);

        // 입력 필드
        inputField = new JTextField();
        inputField.setFont(font);
        add(inputField);

        // 버튼
        guessButton = new JButton("Guess");
        guessButton.setFont(font);
        guessButton.setBackground(new Color(51, 204, 51));
        guessButton.setForeground(Color.WHITE);
        add(guessButton);

        // 결과 메시지
        resultLabel = new JLabel(" ", SwingConstants.CENTER);
        resultLabel.setFont(font);
        resultLabel.setForeground(Color.DARK_GRAY);
        add(resultLabel);

        // 시도 횟수
        triesLabel = new JLabel("Tries: 0", SwingConstants.CENTER);
        triesLabel.setFont(font);
        add(triesLabel);

        // 버튼 클릭 이벤트
        guessButton.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                String text = inputField.getText();
                try {
                    int guess = Integer.parseInt(text);
                    tries++;
                    triesLabel.setText("Tries: " + tries);

                    if (guess < answer) {
                        resultLabel.setText("🔻 Up! Try a higher number.");
                        resultLabel.setForeground(new Color(255, 102, 102));
                    } else if (guess > answer) {
                        resultLabel.setText("🔺 Down! Try a lower number.");
                        resultLabel.setForeground(new Color(255, 102, 102));
                    } else {
                        resultLabel.setText("🎉 Correct! It was " + answer + "!");
                        resultLabel.setForeground(new Color(0, 153, 76));
                        JOptionPane.showMessageDialog(null, "🎉 You got it in " + tries + " tries!", 
                            "Congratulations!", JOptionPane.INFORMATION_MESSAGE);
                        resetGame();
                    }

                } catch (NumberFormatException ex) {
                    JOptionPane.showMessageDialog(null, "Please enter a valid number!", 
                        "Error", JOptionPane.ERROR_MESSAGE);
                }
                inputField.setText("");
            }
        });

        setVisible(true);
    }

    // 게임 리셋
    private void resetGame() {
        answer = new Random().nextInt(100) + 1;
        tries = 0;
        triesLabel.setText("Tries: 0");
        resultLabel.setText(" ");
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(() -> new GUIUpDownGame());
    }
}